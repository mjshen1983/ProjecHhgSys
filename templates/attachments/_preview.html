{# Partial: render an inline preview for PDFs and Office files (via generated PDF preview), otherwise show download link #}
{% load static %}
{% with ext=attachment.file_extension|lower %}
  {% if ext == 'pdf' or ext == 'doc' or ext == 'docx' or ext == 'xls' or ext == 'xlsx' or ext == 'ppt' or ext == 'pptx' %}
    <div class="attachment-preview">
      <iframe src="{% url 'knowledge_attachment_serve' attachment.item.id attachment.id %}" width="100%" height="600" frameborder="0"></iframe>
      <div style="margin-top:8px;"><a href="{{ attachment.file.url }}" download>下载原始文件</a></div>
    </div>
  {% else %}
    <a class="header__button header__button--primary" href="{{ attachment.file.url }}" download>{{ attachment.filename|default:attachment.file.name }}</a>
  {% endif %}
{% endwith %}
